!function(){"use strict";!function(){const e=e=>e&&decodeURIComponent(document.cookie.replace(new RegExp("(?:(?:^|.*;)\\s*"+encodeURIComponent(e).replace(/[\-\.\+\*]/g,"\\$&")+"\\s*\\=\\s*([^;]*).*$)|^.*$"),"$1"))||null;let t=jQuery;const o=jQuery;function i(){function t(t){o(".courier_notice[data-courier-notice-id='"+t+"']").fadeOut(500,(function(){if(0===window.courier_notices_modal_notices.length)o(".courier-modal-overlay").addClass("hide").hide();else if(window.courier_notices_modal_notices&&window.courier_notices_modal_notices.length>0){const e=new CustomEvent("courierModalNext",{detail:{notice_id:t}});document.dispatchEvent(e)}})),function(t){let o=e("dismissed_notices");o=JSON.parse(o),o=o||[],-1===o.indexOf(t)&&o.push(t),((e,t,o,i,n,c)=>{if(!e||/^(?:expires|max\-age|path|domain|secure)$/i.test(e))return!1;i||(i="/");let r="";if(o)switch(o.constructor){case Number:r=o===1/0?"; expires=Fri, 31 Dec 9999 23:59:59 GMT":"; max-age="+o;break;case String:r="; expires="+o;break;case Date:r="; expires="+o.toUTCString()}document.cookie=encodeURIComponent(e)+"="+encodeURIComponent(t)+r+(n?"; domain="+n:"")+(i?"; path="+i:"")+(c?"; secure":"")})("dismissed_notices",JSON.stringify(o))}(t)}o("body").on("click",".courier-close, .trigger-close",(function(e){let i=o(this),n=i.attr("href");if(!0!==i.data("dismiss")){e.preventDefault(),e.stopPropagation(),i.data("dismiss",!0);let c=i.parents(".courier-notice"),r=parseInt(c.data("courier-notice-id"),10);if(0===c.length||isNaN(r))return;courier_notices_data.user_id&&courier_notices_data.user_id>0?(o.post({url:courier_notices_data.notice_endpoint+r+"/dismiss",data:{dismiss_nonce:courier_notices_data.dismiss_nonce,user_id:courier_notices_data.user_id},beforeSend:function(e){e.setRequestHeader("X-WP-Nonce",courier_notices_data.wp_rest_nonce)}}).done((function(){t(r)})),n&&"#"!==n&&o(document).ajaxComplete((function(e,t,o){window.location=n}))):(t(r),n&&"#"!==n&&(window.location=n))}}))}jQuery((function(){var o;o=function(){let o=t('.courier-notices[data-courier-ajax="true"]');if(0===o.length)return;if(!courier_notices_data.has_notices)return;o.attr("data-loaded",!1);let i=[];if(o.each((function(){let e=t(this).data("courier-placement");e&&-1===i.indexOf(e)&&i.push(e)})),0===i.length)return;let n=new IntersectionObserver((function(o){o.some((function(e){return 1===e.intersectionRatio&&"false"===e.target.getAttribute("data-loaded")}))&&function(o){if(t('.courier-notices[data-loaded="true"]').length>0)return;let i={placements:o,format:"html",post_info:{},user_id:"0"!==courier_notices_data.user_id?courier_notices_data.user_id:""};void 0!==courier_notices_data.post_info&&(i.post_info=courier_notices_data.post_info);let n=e("dismissed_notices");n=JSON.parse(n),n=n||[],t.ajax({method:"GET",beforeSend:function(e){"0"!==courier_notices_data.user_id&&e.setRequestHeader("X-WP-Nonce",courier_notices_data.wp_rest_nonce)},url:courier_notices_data.notices_all_endpoint,data:i}).done((function(e){e&&"object"==typeof e&&function(e,o){Object.keys(e).forEach((function(i){let n=e[i],c=t('.courier-notices[data-courier-placement="'+i+'"]');0!==c.length&&("popup-modal"===i?function(e,o){let i=[];Object.keys(e).forEach((function(t){-1===o.indexOf(parseInt(t))&&i.push(e[t])})),i.length>0&&(window.courier_notices_modal_notices=i,setTimeout((function(){!function(e){let o=t(window.courier_notices_modal_notices[0]);o.hide(),o.length<1||(t('.courier-notices[data-courier-placement="popup-modal"] .courier-modal-overlay').append(o),t(".courier-modal-overlay").removeClass("hide").show(),o.slideDown("fast"),window.courier_notices_modal_notices.splice(0,1))}()}),500))}(n,o):Object.keys(n).forEach((function(e){if(-1!==o.indexOf(parseInt(e)))return;let r=t(n[e]).hide();c.append(r),r.slideDown("fast","swing",(function(){const t=new CustomEvent("courierNoticeDisplayed",{detail:{notice_id:e,placement:i}});document.dispatchEvent(t)}))})),c.attr("data-loaded","true"))}))}(e,n)})).fail((function(e,t,o){console.error("Courier Notices: Failed to load notices",t,o)}))}(i)}),{threshold:1});o.each((function(){n.observe(this)}))},"interactive"===document.readyState||"complete"===document.readyState?o():document.addEventListener("DOMContentLoaded",o),i()}))}()}();